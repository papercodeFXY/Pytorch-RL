import numpy as np
import pandas as pd
import random
import time
import sys
if sys.version_info.major == 2:
    import Tkinter as tk
else:
    import tkinter as tk


class Cluster(tk.Tk, object):
    def __init__(self, state_init, server_attribute):
        super(Cluster, self).__init__()
        # self.action_space = np.array([[0,0],[0,1],[0,2],[0,3],
        #                               [1,0],[1,1],[1,2],[1,3],
        #                               [2,0],[2,1],[2,2],[2,3],
        #                               [3,0],[3,1],[3,2],[3,3],
        #                               [4,0],[4,1],[4,2],[4,3],
        #                               [5,0],[5,1],[5,2],[5,3],
        #                               [6,0],[6,1],[6,2],[6,3],
        #                               [7,0],[7,1],[7,2],[7,3]
        #                               ])
        self.server_number = 8

        # self.cost_matrix = pd.DataFrame(np.array([[0,1,5,12],
        #                                           [1,0,4,2],
        #                                           [5,4,0,3],
        #                                           [12,2,3,0]]),
        #                                     columns=[0, 1, 2, 3])
        self.cost_matrix = pd.DataFrame(np.array([[0,1,5,12,7,10,15,9],
                                                  [1,0,4,2,8,6,11,10],
                                                  [5,4,0,3,11,13,8,5],
                                                  [12,2,3,0,7,6,10,4],
                                                  [7,8,11,7,0,12,9,5],
                                                  [10,6,13,6,12,0,3,8],
                                                  [15,11,8,10,9,3,0,10],
                                                  [9,10,5,4,5,8,10,0]]),
                                        columns=[0, 1, 2, 3, 4, 5, 6, 7])
        self.server_attribute = server_attribute
        self.QSs = self.read_file()
        # self.action_space = np.array([[0, 0], [0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],
        #                               [1, 0], [1,1],[1,2],[1,3],[1,4],[1,5],[1,6],[1,7],
        #                               [2, 0], [2,1],[2,2],[2,3],[2,4],[2,5],[2,6],[2,7],
        #                               [3, 0], [3,1],[3,2],[3,3],[3,4],[3,5],[3,6],[3,7],
        #                               [4, 0], [4,1],[4,2],[4,3],[4,4],[4,5],[4,6],[4,7],
        #                               [5, 0], [5,1],[5,2],[5,3],[5,4],[5,5],[5,6],[5,7],
        #                               [6, 0], [6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[6,7],
        #                               [7, 0], [7,1],[7,2],[7,3],[7,4],[7,5],[7,6],[7,7],
        #                               [8, 0], [8,1],[8,2],[8,3],[8,4],[8,5],[8,6],[8,7],
        #                               [9, 0], [9,1],[9,2],[9,3],[9,4],[9,5],[9,6],[9,7],
        #                               [10, 0], [10,1],[10,2],[10,3],[10,4],[10,5],[10,6],[10,7],
        #                               [11, 0], [11,1],[11,2],[11,3],[11,4],[11,5],[11,6],[11,7],
        #                               [12, 0], [12,1],[12,2],[12,3],[12,4],[12,5],[12,6],[12,7],
        #                               [13, 0], [13,1],[13,2],[13,3],[13,4],[13,5],[13,6],[13,7],
        #                               [14, 0], [14,1],[14,2],[14,3],[14,4],[14,5],[14,6],[14,7],
        #                               [15, 0], [15,1],[15,2],[15,3],[15,4],[15,5],[15,6],[15,7],
        #                               [16, 0], [16,1],[16,2],[16,3],[16,4],[16,5],[16,6],[16,7],
        #                               [17, 0], [17,1],[17,2],[17,3],[17,4],[17,5],[17,6],[17,7],
        #                               [18, 0], [18,1],[18,2],[18,3],[18,4],[18,5],[18,6],[18,7],
        #                               [19, 0], [19,1],[19,2],[19,3],[19,4],[19,5],[19,6],[19,7],
        #                               [20, 0], [20,1],[20,2],[20,3],[20,4],[20,5],[20,6],[20,7],
        #                               [21, 0], [21,1],[21,2],[21,3],[21,4],[21,5],[21,6],[21,7],
        #                               [22, 0], [22,1],[22,2],[22,3],[22,4],[22,5],[22,6],[22,7],
        #                               [23, 0], [23,1],[23,2],[23,3],[23,4],[23,5],[23,6],[23,7],
        #                               [24, 0],[24, 1] ,[24, 2] ,[24, 3] ,[24, 4] ,[24, 5] ,[24, 6] ,[24, 7] ,
        #                               [25, 0],[25, 1] ,[25, 2] ,[25, 3] ,[25, 4] ,[25, 5] ,[25, 6] ,[25, 7] ,
        #                               [26, 0],[26, 1] ,[26, 2] ,[26, 3] ,[26, 4] ,[26, 5] ,[26, 6] ,[26, 7] ,
        #                               [27, 0],[27, 1] ,[27, 2] ,[27, 3] ,[27, 4] ,[27, 5] ,[27, 6] ,[27, 7] ,
        #                               [28, 0],[28, 1] ,[28, 2] ,[28, 3] ,[28, 4] ,[28, 5] ,[28, 6] ,[28, 7] ,
        #                               [29, 0],[29, 1] ,[29, 2] ,[29, 3] ,[29, 4] ,[29, 5] ,[29, 6] ,[29, 7] ,
        #                               [30, 0],[30, 1] ,[30, 2] ,[30, 3] ,[30, 4] ,[30, 5] ,[30, 6] ,[30, 7] ,
        #                               [31, 0],[31, 1] ,[31, 2] ,[31, 3] ,[31, 4] ,[31, 5] ,[31, 6] ,[31, 7] ,
        #                               [32, 0],[32, 1] ,[32, 2] ,[32, 3] ,[32, 4] ,[32, 5] ,[32, 6] ,[32, 7] ,
        #                               [33, 0],[33, 1] ,[33, 2] ,[33, 3] ,[33, 4] ,[33, 5] ,[33, 6] ,[33, 7] ,
        #                               [34, 0],[34, 1] ,[34, 2] ,[34, 3] ,[34, 4] ,[34, 5] ,[34, 6] ,[34, 7] ,
        #                               [35, 0],[35, 1] ,[35, 2] ,[35, 3] ,[35, 4] ,[35, 5] ,[35, 6] ,[35, 7] ,
        #                               [36, 0],[36, 1] ,[36, 2] ,[36, 3] ,[36, 4] ,[36, 5] ,[36, 6] ,[36, 7] ,
        #                               [37, 0],[37, 1] ,[37, 2] ,[37, 3] ,[37, 4] ,[37, 5] ,[37, 6] ,[37, 7] ,
        #                               [38, 0],[38, 1] ,[38, 2] ,[38, 3] ,[38, 4] ,[38, 5] ,[38, 6] ,[38, 7] ,
        #                               [39, 0],[39, 1] ,[39, 2] ,[39, 3] ,[39, 4] ,[39, 5] ,[39, 6] ,[39, 7] ,
        #                               [40, 0],[40, 1] ,[40, 2] ,[40, 3] ,[40, 4] ,[40, 5] ,[40, 6] ,[40, 7] ,
        #                               [41, 0],[41, 1] ,[41, 2] ,[41, 3] ,[41, 4] ,[41, 5] ,[41, 6] ,[41, 7] ,
        #                               [42, 0],[42, 1] ,[42, 2] ,[42, 3] ,[42, 4] ,[42, 5] ,[42, 6] ,[42, 7] ,
        #                               [43, 0],[43, 1] ,[43, 2] ,[43, 3] ,[43, 4] ,[43, 5] ,[43, 6] ,[43, 7] ,
        #                               [44, 0],[44, 1] ,[44, 2] ,[44, 3] ,[44, 4] ,[44, 5] ,[44, 6] ,[44, 7] ,
        #                               [45, 0],[45, 1] ,[45, 2] ,[45, 3] ,[45, 4] ,[45, 5] ,[45, 6] ,[45, 7] ,
        #                               [46, 0],[46, 1] ,[46, 2] ,[46, 3] ,[46, 4] ,[46, 5] ,[46, 6] ,[46, 7] ,
        #                               [47, 0],[47, 1] ,[47, 2] ,[47, 3] ,[47, 4] ,[47, 5] ,[47, 6] ,[47, 7] ,
        #                               [48, 0],[48, 1] ,[48, 2] ,[48, 3] ,[48, 4] ,[48, 5] ,[48, 6] ,[48, 7] ,
        #                               [49, 0],[49, 1] ,[49, 2] ,[49, 3] ,[49, 4] ,[49, 5] ,[49, 6] ,[49, 7] ,
        #                               [50, 0],[50, 1] ,[50, 2] ,[50, 3] ,[50, 4] ,[50, 5] ,[50, 6] ,[50, 7] ,
        #                               [51, 0],[51, 1] ,[51, 2] ,[51, 3] ,[51, 4] ,[51, 5] ,[51, 6] ,[51, 7] ,
        #                               [52, 0],[52, 1] ,[52, 2] ,[52, 3] ,[52, 4] ,[52, 5] ,[52, 6] ,[52, 7] ,
        #                               [53, 0],[53, 1] ,[53, 2] ,[53, 3] ,[53, 4] ,[53, 5] ,[53, 6] ,[53, 7] ,
        #                               [54, 0],[54, 1] ,[54, 2] ,[54, 3] ,[54, 4] ,[54, 5] ,[54, 6] ,[54, 7] ,
        #                               [55, 0],[55, 1] ,[55, 2] ,[55, 3] ,[55, 4] ,[55, 5] ,[55, 6] ,[55, 7] ,
        #                               [56, 0],[56, 1] ,[56, 2] ,[56, 3] ,[56, 4] ,[56, 5] ,[56, 6] ,[56, 7] ,
        #                               [57, 0],[57, 1] ,[57, 2] ,[57, 3] ,[57, 4] ,[57, 5] ,[57, 6] ,[57, 7] ,
        #                               [58, 0],[58, 1] ,[58, 2] ,[58, 3] ,[58, 4] ,[58, 5] ,[58, 6] ,[58, 7] ,
        #                               [59, 0],[59, 1] ,[59, 2] ,[59, 3] ,[59, 4] ,[59, 5] ,[59, 6] ,[59, 7] ,
        #                               [60, 0],[60, 1] ,[60, 2] ,[60, 3] ,[60, 4] ,[60, 5] ,[60, 6] ,[60, 7] ,
        #                               [61, 0],[61, 1] ,[61, 2] ,[61, 3] ,[61, 4] ,[61, 5] ,[61, 6] ,[61, 7] ,
        #                               [62, 0],[62, 1] ,[62, 2] ,[62, 3] ,[62, 4] ,[62, 5] ,[62, 6] ,[62, 7] ,
        #                               [63, 0],[63, 1] ,[63, 2] ,[63, 3] ,[63, 4] ,[63, 5] ,[63, 6] ,[63, 7] ,
        #                               [64, 0],[64, 1] ,[64, 2] ,[64, 3] ,[64, 4] ,[64, 5] ,[64, 6] ,[64, 7] ,
        #                               [65, 0],[65, 1] ,[65, 2] ,[65, 3] ,[65, 4] ,[65, 5] ,[65, 6] ,[65, 7] ,
        #                               [66, 0],[66, 1] ,[66, 2] ,[66, 3] ,[66, 4] ,[66, 5] ,[66, 6] ,[66, 7] ,
        #                               [67, 0],[67, 1] ,[67, 2] ,[67, 3] ,[67, 4] ,[67, 5] ,[67, 6] ,[67, 7] ,
        #                               [68, 0],[68, 1] ,[68, 2] ,[68, 3] ,[68, 4] ,[68, 5] ,[68, 6] ,[68, 7] ,
        #                               [69, 0],[69, 1] ,[69, 2] ,[69, 3] ,[69, 4] ,[69, 5] ,[69, 6] ,[69, 7] ,
        #                               [70, 0],[70, 1] ,[70, 2] ,[70, 3] ,[70, 4] ,[70, 5] ,[70, 6] ,[70, 7] ,
        #                               [71, 0],[71, 1] ,[71, 2] ,[71, 3] ,[71, 4] ,[71, 5] ,[71, 6] ,[71, 7] ,
        #                               [72, 0],[72, 1] ,[72, 2] ,[72, 3] ,[72, 4] ,[72, 5] ,[72, 6] ,[72, 7] ,
        #                               [73, 0],[73, 1] ,[73, 2] ,[73, 3] ,[73, 4] ,[73, 5] ,[73, 6] ,[73, 7] ,
        #                               [74, 0],[74, 1] ,[74, 2] ,[74, 3] ,[74, 4] ,[74, 5] ,[74, 6] ,[74, 7] ,
        #                               [75, 0],[75, 1] ,[75, 2] ,[75, 3] ,[75, 4] ,[75, 5] ,[75, 6] ,[75, 7] ,
        #                               [76, 0],[76, 1] ,[76, 2] ,[76, 3] ,[76, 4] ,[76, 5] ,[76, 6] ,[76, 7] ,
        #                               [77, 0],[77, 1] ,[77, 2] ,[77, 3] ,[77, 4] ,[77, 5] ,[77, 6] ,[77, 7] ,
        #                               [78, 0],[78, 1] ,[78, 2] ,[78, 3] ,[78, 4] ,[78, 5] ,[78, 6] ,[78, 7] ,
        #                               [79, 0],[79, 1] ,[79, 2] ,[79, 3] ,[79, 4] ,[79, 5] ,[79, 6] ,[79, 7] ,
        #                               [80, 0],[80, 1] ,[80, 2] ,[80, 3] ,[80, 4] ,[80, 5] ,[80, 6] ,[80, 7] ,
        #                               [81, 0],[81, 1] ,[81, 2] ,[81, 3] ,[81, 4] ,[81, 5] ,[81, 6] ,[81, 7] ,
        #                               [82, 0],[82, 1] ,[82, 2] ,[82, 3] ,[82, 4] ,[82, 5] ,[82, 6] ,[82, 7] ,
        #                               [83, 0],[83, 1] ,[83, 2] ,[83, 3] ,[83, 4] ,[83, 5] ,[83, 6] ,[83, 7] ,
        #                               [84, 0],[84, 1] ,[84, 2] ,[84, 3] ,[84, 4] ,[84, 5] ,[84, 6] ,[84, 7] ,
        #                               [85, 0],[85, 1] ,[85, 2] ,[85, 3] ,[85, 4] ,[85, 5] ,[85, 6] ,[85, 7] ,
        #                               [86, 0],[86, 1] ,[86, 2] ,[86, 3] ,[86, 4] ,[86, 5] ,[86, 6] ,[86, 7] ,
        #                               [87, 0],[87, 1] ,[87, 2] ,[87, 3] ,[87, 4] ,[87, 5] ,[87, 6] ,[87, 7] ,
        #                               [88, 0],[88, 1] ,[88, 2] ,[88, 3] ,[88, 4] ,[88, 5] ,[88, 6] ,[88, 7] ,
        #                               [89, 0],[89, 1] ,[89, 2] ,[89, 3] ,[89, 4] ,[89, 5] ,[89, 6] ,[89, 7] ,
        #                               [90, 0],[90, 1] ,[90, 2] ,[90, 3] ,[90, 4] ,[90, 5] ,[90, 6] ,[90, 7] ,
        #                               [91, 0],[91, 1] ,[91, 2] ,[91, 3] ,[91, 4] ,[91, 5] ,[91, 6] ,[91, 7] ,
        #                               [92, 0],[92, 1] ,[92, 2] ,[92, 3] ,[92, 4] ,[92, 5] ,[92, 6] ,[92, 7] ,
        #                               [93, 0],[93, 1] ,[93, 2] ,[93, 3] ,[93, 4] ,[93, 5] ,[93, 6] ,[93, 7] ,
        #                               [94, 0],[94, 1] ,[94, 2] ,[94, 3] ,[94, 4] ,[94, 5] ,[94, 6] ,[94, 7] ,
        #                               [95, 0],[95, 1] ,[95, 2] ,[95, 3] ,[95, 4] ,[95, 5] ,[95, 6] ,[95, 7] ,
        #                               [96, 0],[96, 1] ,[96, 2] ,[96, 3] ,[96, 4] ,[96, 5] ,[96, 6] ,[96, 7] ,
        #                               [97, 0],[97, 1] ,[97, 2] ,[97, 3] ,[97, 4] ,[97, 5] ,[97, 6] ,[97, 7] ,
        #                               [98, 0],[98, 1] ,[98, 2] ,[98, 3] ,[98, 4] ,[98, 5] ,[98, 6] ,[98, 7] ,
        #                               [99, 0],[99, 1] ,[99, 2] ,[99, 3] ,[99, 4] ,[99, 5] ,[99, 6] ,[99, 7] ,
        #                               [100, 0],[100, 1] ,[100, 2] ,[100, 3] ,[100, 4] ,[100, 5] ,[100, 6] ,[100, 7] ,
        #                               [101, 0],[101, 1] ,[101, 2] ,[101, 3] ,[101, 4] ,[101, 5] ,[101, 6] ,[101, 7] ,
        #                               [102, 0],[102, 1] ,[102, 2] ,[102, 3] ,[102, 4] ,[102, 5] ,[102, 6] ,[102, 7] ,
        #                               [103, 0],[103, 1] ,[103, 2] ,[103, 3] ,[103, 4] ,[103, 5] ,[103, 6] ,[103, 7] ,
        #                               [104, 0],[104, 1] ,[104, 2] ,[104, 3] ,[104, 4] ,[104, 5] ,[104, 6] ,[104, 7] ,
        #                               [105, 0],[105, 1] ,[105, 2] ,[105, 3] ,[105, 4] ,[105, 5] ,[105, 6] ,[105, 7] ,
        #                               [106, 0],[106, 1] ,[106, 2] ,[106, 3] ,[106, 4] ,[106, 5] ,[106, 6] ,[106, 7] ,
        #                               [107, 0],[107, 1] ,[107, 2] ,[107, 3] ,[107, 4] ,[107, 5] ,[107, 6] ,[107, 7] ,
        #                               [108, 0],[108, 1] ,[108, 2] ,[108, 3] ,[108, 4] ,[108, 5] ,[108, 6] ,[108, 7] ,
        #                               [109, 0],[109, 1] ,[109, 2] ,[109, 3] ,[109, 4] ,[109, 5] ,[109, 6] ,[109, 7] ,
        #                               [110, 0],[110, 1] ,[110, 2] ,[110, 3] ,[110, 4] ,[110, 5] ,[110, 6] ,[110, 7] ,
        #                               [111, 0],[111, 1] ,[111, 2] ,[111, 3] ,[111, 4] ,[111, 5] ,[111, 6] ,[111, 7] ,
        #                               [112, 0],[112, 1] ,[112, 2] ,[112, 3] ,[112, 4] ,[112, 5] ,[112, 6] ,[112, 7] ,
        #                               [113, 0],[113, 1] ,[113, 2] ,[113, 3] ,[113, 4] ,[113, 5] ,[113, 6] ,[113, 7] ,
        #                               [114, 0],[114, 1] ,[114, 2] ,[114, 3] ,[114, 4] ,[114, 5] ,[114, 6] ,[114, 7] ,
        #                               [115, 0],[115, 1] ,[115, 2] ,[115, 3] ,[115, 4] ,[115, 5] ,[115, 6] ,[115, 7] ,
        #                               [116, 0],[116, 1] ,[116, 2] ,[116, 3] ,[116, 4] ,[116, 5] ,[116, 6] ,[116, 7] ,
        #                               [117, 0],[117, 1] ,[117, 2] ,[117, 3] ,[117, 4] ,[117, 5] ,[117, 6] ,[117, 7] ,
        #                               [118, 0],[118, 1] ,[118, 2] ,[118, 3] ,[118, 4] ,[118, 5] ,[118, 6] ,[118, 7] ,
        #                               [119, 0],[119, 1] ,[119, 2] ,[119, 3] ,[119, 4] ,[119, 5] ,[119, 6] ,[119, 7] ,
        #                               [120, 0],[120, 1] ,[120, 2] ,[120, 3] ,[120, 4] ,[120, 5] ,[120, 6] ,[120, 7] ,
        #                               [121, 0],[121, 1] ,[121, 2] ,[121, 3] ,[121, 4] ,[121, 5] ,[121, 6] ,[121, 7] ,
        #                               [122, 0],[122, 1] ,[122, 2] ,[122, 3] ,[122, 4] ,[122, 5] ,[122, 6] ,[122, 7] ,
        #                               [123, 0],[123, 1] ,[123, 2] ,[123, 3] ,[123, 4] ,[123, 5] ,[123, 6] ,[123, 7] ,
        #                               [124, 0],[124, 1] ,[124, 2] ,[124, 3] ,[124, 4] ,[124, 5] ,[124, 6] ,[124, 7] ,
        #                               [125, 0],[125, 1] ,[125, 2] ,[125, 3] ,[125, 4] ,[125, 5] ,[125, 6] ,[125, 7] ,
        #                               [126, 0],[126, 1] ,[126, 2] ,[126, 3] ,[126, 4] ,[126, 5] ,[126, 6] ,[126, 7] ,
        #                               [127, 0],[127, 1] ,[127, 2] ,[127, 3] ,[127, 4] ,[127, 5] ,[127, 6] ,[127, 7] ,
        #                               [128, 0],[128, 1] ,[128, 2] ,[128, 3] ,[128, 4] ,[128, 5] ,[128, 6] ,[128, 7] ,
        #                               [129, 0],[129, 1] ,[129, 2] ,[129, 3] ,[129, 4] ,[129, 5] ,[129, 6] ,[129, 7] ,
        #                               [130, 0],[130, 1] ,[130, 2] ,[130, 3] ,[130, 4] ,[130, 5] ,[130, 6] ,[130, 7] ,
        #                               [131, 0],[131, 1] ,[131, 2] ,[131, 3] ,[131, 4] ,[131, 5] ,[131, 6] ,[131, 7] ,
        #                               [132, 0],[132, 1] ,[132, 2] ,[132, 3] ,[132, 4] ,[132, 5] ,[132, 6] ,[132, 7] ,
        #                               [133, 0],[133, 1] ,[133, 2] ,[133, 3] ,[133, 4] ,[133, 5] ,[133, 6] ,[133, 7] ,
        #                               [134, 0],[134, 1] ,[134, 2] ,[134, 3] ,[134, 4] ,[134, 5] ,[134, 6] ,[134, 7] ,
        #                               [135, 0],[135, 1] ,[135, 2] ,[135, 3] ,[135, 4] ,[135, 5] ,[135, 6] ,[135, 7] ,
        #                               [136, 0],[136, 1] ,[136, 2] ,[136, 3] ,[136, 4] ,[136, 5] ,[136, 6] ,[136, 7] ,
        #                               [137, 0],[137, 1] ,[137, 2] ,[137, 3] ,[137, 4] ,[137, 5] ,[137, 6] ,[137, 7] ,
        #                               [138, 0],[138, 1] ,[138, 2] ,[138, 3] ,[138, 4] ,[138, 5] ,[138, 6] ,[138, 7] ,
        #                               [139, 0],[139, 1] ,[139, 2] ,[139, 3] ,[139, 4] ,[139, 5] ,[139, 6] ,[139, 7] ,
        #                               [140, 0],[140, 1] ,[140, 2] ,[140, 3] ,[140, 4] ,[140, 5] ,[140, 6] ,[140, 7] ,
        #                               [141, 0],[141, 1] ,[141, 2] ,[141, 3] ,[141, 4] ,[141, 5] ,[141, 6] ,[141, 7] ,
        #                               [142, 0],[142, 1] ,[142, 2] ,[142, 3] ,[142, 4] ,[142, 5] ,[142, 6] ,[142, 7] ,
        #                               [143, 0],[143, 1] ,[143, 2] ,[143, 3] ,[143, 4] ,[143, 5] ,[143, 6] ,[143, 7] ,
        #                               [144, 0],[144, 1] ,[144, 2] ,[144, 3] ,[144, 4] ,[144, 5] ,[144, 6] ,[144, 7] ,
        #                               [145, 0],[145, 1] ,[145, 2] ,[145, 3] ,[145, 4] ,[145, 5] ,[145, 6] ,[145, 7] ,
        #                               [146, 0],[146, 1] ,[146, 2] ,[146, 3] ,[146, 4] ,[146, 5] ,[146, 6] ,[146, 7] ,
        #                               [147, 0],[147, 1] ,[147, 2] ,[147, 3] ,[147, 4] ,[147, 5] ,[147, 6] ,[147, 7] ,
        #                               [148, 0],[148, 1] ,[148, 2] ,[148, 3] ,[148, 4] ,[148, 5] ,[148, 6] ,[148, 7] ,
        #                               [149, 0],[149, 1] ,[149, 2] ,[149, 3] ,[149, 4] ,[149, 5] ,[149, 6] ,[149, 7] ,
        #                               [150, 0],[150, 1] ,[150, 2] ,[150, 3] ,[150, 4] ,[150, 5] ,[150, 6] ,[150, 7] ,
        #                               [151, 0],[151, 1] ,[151, 2] ,[151, 3] ,[151, 4] ,[151, 5] ,[151, 6] ,[151, 7] ,
        #                               [152, 0],[152, 1] ,[152, 2] ,[152, 3] ,[152, 4] ,[152, 5] ,[152, 6] ,[152, 7] ,
        #                               [153, 0],[153, 1] ,[153, 2] ,[153, 3] ,[153, 4] ,[153, 5] ,[153, 6] ,[153, 7] ,
        #                               [154, 0],[154, 1] ,[154, 2] ,[154, 3] ,[154, 4] ,[154, 5] ,[154, 6] ,[154, 7] ,
        #                               [155, 0],[155, 1] ,[155, 2] ,[155, 3] ,[155, 4] ,[155, 5] ,[155, 6] ,[155, 7] ,
        #                               [156, 0],[156, 1] ,[156, 2] ,[156, 3] ,[156, 4] ,[156, 5] ,[156, 6] ,[156, 7] ,
        #                               [157, 0],[157, 1] ,[157, 2] ,[157, 3] ,[157, 4] ,[157, 5] ,[157, 6] ,[157, 7] ,
        #                               [158, 0],[158, 1] ,[158, 2] ,[158, 3] ,[158, 4] ,[158, 5] ,[158, 6] ,[158, 7] ,
        #                               [159, 0],[159, 1] ,[159, 2] ,[159, 3] ,[159, 4] ,[159, 5] ,[159, 6] ,[159, 7] ,
        #                               [160, 0],[160, 1] ,[160, 2] ,[160, 3] ,[160, 4] ,[160, 5] ,[160, 6] ,[160, 7] ,
        #                               [161, 0],[161, 1] ,[161, 2] ,[161, 3] ,[161, 4] ,[161, 5] ,[161, 6] ,[161, 7] ,
        #                               [162, 0],[162, 1] ,[162, 2] ,[162, 3] ,[162, 4] ,[162, 5] ,[162, 6] ,[162, 7] ,
        #                               [163, 0],[163, 1] ,[163, 2] ,[163, 3] ,[163, 4] ,[163, 5] ,[163, 6] ,[163, 7] ,
        #                               [164, 0],[164, 1] ,[164, 2] ,[164, 3] ,[164, 4] ,[164, 5] ,[164, 6] ,[164, 7] ,
        #                               [165, 0],[165, 1] ,[165, 2] ,[165, 3] ,[165, 4] ,[165, 5] ,[165, 6] ,[165, 7] ,
        #                               [166, 0],[166, 1] ,[166, 2] ,[166, 3] ,[166, 4] ,[166, 5] ,[166, 6] ,[166, 7] ,
        #                               [167, 0],[167, 1] ,[167, 2] ,[167, 3] ,[167, 4] ,[167, 5] ,[167, 6] ,[167, 7] ,
        #                               [168, 0],[168, 1] ,[168, 2] ,[168, 3] ,[168, 4] ,[168, 5] ,[168, 6] ,[168, 7] ,
        #                               [169, 0],[169, 1] ,[169, 2] ,[169, 3] ,[169, 4] ,[169, 5] ,[169, 6] ,[169, 7] ,
        #                               [170, 0],[170, 1] ,[170, 2] ,[170, 3] ,[170, 4] ,[170, 5] ,[170, 6] ,[170, 7] ,
        #                               [171, 0],[171, 1] ,[171, 2] ,[171, 3] ,[171, 4] ,[171, 5] ,[171, 6] ,[171, 7] ,
        #                               [172, 0],[172, 1] ,[172, 2] ,[172, 3] ,[172, 4] ,[172, 5] ,[172, 6] ,[172, 7] ,
        #                               [173, 0],[173, 1] ,[173, 2] ,[173, 3] ,[173, 4] ,[173, 5] ,[173, 6] ,[173, 7] ,
        #                               [174, 0],[174, 1] ,[174, 2] ,[174, 3] ,[174, 4] ,[174, 5] ,[174, 6] ,[174, 7] ,
        #                               [175, 0],[175, 1] ,[175, 2] ,[175, 3] ,[175, 4] ,[175, 5] ,[175, 6] ,[175, 7] ,
        #                               [176, 0],[176, 1] ,[176, 2] ,[176, 3] ,[176, 4] ,[176, 5] ,[176, 6] ,[176, 7] ,
        #                               [177, 0],[177, 1] ,[177, 2] ,[177, 3] ,[177, 4] ,[177, 5] ,[177, 6] ,[177, 7] ,
        #                               [178, 0],[178, 1] ,[178, 2] ,[178, 3] ,[178, 4] ,[178, 5] ,[178, 6] ,[178, 7] ,
        #                               [179, 0],[179, 1] ,[179, 2] ,[179, 3] ,[179, 4] ,[179, 5] ,[179, 6] ,[179, 7] ,
        #                               [180, 0],[180, 1] ,[180, 2] ,[180, 3] ,[180, 4] ,[180, 5] ,[180, 6] ,[180, 7] ,
        #                               [181, 0],[181, 1] ,[181, 2] ,[181, 3] ,[181, 4] ,[181, 5] ,[181, 6] ,[181, 7] ,
        #                               [182, 0],[182, 1] ,[182, 2] ,[182, 3] ,[182, 4] ,[182, 5] ,[182, 6] ,[182, 7] ,
        #                               [183, 0],[183, 1] ,[183, 2] ,[183, 3] ,[183, 4] ,[183, 5] ,[183, 6] ,[183, 7] ,
        #                               [184, 0],[184, 1] ,[184, 2] ,[184, 3] ,[184, 4] ,[184, 5] ,[184, 6] ,[184, 7] ,
        #                               [185, 0],[185, 1] ,[185, 2] ,[185, 3] ,[185, 4] ,[185, 5] ,[185, 6] ,[185, 7] ,
        #                               [186, 0],[186, 1] ,[186, 2] ,[186, 3] ,[186, 4] ,[186, 5] ,[186, 6] ,[186, 7] ,
        #                               [187, 0],[187, 1] ,[187, 2] ,[187, 3] ,[187, 4] ,[187, 5] ,[187, 6] ,[187, 7] ,
        #                               [188, 0],[188, 1] ,[188, 2] ,[188, 3] ,[188, 4] ,[188, 5] ,[188, 6] ,[188, 7] ,
        #                               [189, 0],[189, 1] ,[189, 2] ,[189, 3] ,[189, 4] ,[189, 5] ,[189, 6] ,[189, 7] ,
        #                               [190, 0],[190, 1] ,[190, 2] ,[190, 3] ,[190, 4] ,[190, 5] ,[190, 6] ,[190, 7] ,
        #                               [191, 0],[191, 1] ,[191, 2] ,[191, 3] ,[191, 4] ,[191, 5] ,[191, 6] ,[191, 7] ,
        #                               [192, 0],[192, 1] ,[192, 2] ,[192, 3] ,[192, 4] ,[192, 5] ,[192, 6] ,[192, 7] ,
        #                               [193, 0],[193, 1] ,[193, 2] ,[193, 3] ,[193, 4] ,[193, 5] ,[193, 6] ,[193, 7] ,
        #                               [194, 0],[194, 1] ,[194, 2] ,[194, 3] ,[194, 4] ,[194, 5] ,[194, 6] ,[194, 7] ,
        #                               [195, 0],[195, 1] ,[195, 2] ,[195, 3] ,[195, 4] ,[195, 5] ,[195, 6] ,[195, 7] ,
        #                               [196, 0],[196, 1] ,[196, 2] ,[196, 3] ,[196, 4] ,[196, 5] ,[196, 6] ,[196, 7] ,
        #                               [197, 0],[197, 1] ,[197, 2] ,[197, 3] ,[197, 4] ,[197, 5] ,[197, 6] ,[197, 7] ,
        #                               [198, 0],[198, 1] ,[198, 2] ,[198, 3] ,[198, 4] ,[198, 5] ,[198, 6] ,[198, 7] ,
        #                               [199, 0],[199, 1] ,[199, 2] ,[199, 3] ,[199, 4] ,[199, 5] ,[199, 6] ,[199, 7] ,
        #                               [200, 0],[200, 1] ,[200, 2] ,[200, 3] ,[200, 4] ,[200, 5] ,[200, 6] ,[200, 7] ,
        #                               [201, 0],[201, 1] ,[201, 2] ,[201, 3] ,[201, 4] ,[201, 5] ,[201, 6] ,[201, 7] ,
        #                               [202, 0],[202, 1] ,[202, 2] ,[202, 3] ,[202, 4] ,[202, 5] ,[202, 6] ,[202, 7] ,
        #                               [203, 0],[203, 1] ,[203, 2] ,[203, 3] ,[203, 4] ,[203, 5] ,[203, 6] ,[203, 7] ,
        #                               [204, 0],[204, 1] ,[204, 2] ,[204, 3] ,[204, 4] ,[204, 5] ,[204, 6] ,[204, 7] ,
        #                               [205, 0],[205, 1] ,[205, 2] ,[205, 3] ,[205, 4] ,[205, 5] ,[205, 6] ,[205, 7] ,
        #                               [206, 0],[206, 1] ,[206, 2] ,[206, 3] ,[206, 4] ,[206, 5] ,[206, 6] ,[206, 7] ,
        #                               [207, 0],[207, 1] ,[207, 2] ,[207, 3] ,[207, 4] ,[207, 5] ,[207, 6] ,[207, 7] ,
        #                               [208, 0],[208, 1] ,[208, 2] ,[208, 3] ,[208, 4] ,[208, 5] ,[208, 6] ,[208, 7] ,
        #                               [209, 0],[209, 1] ,[209, 2] ,[209, 3] ,[209, 4] ,[209, 5] ,[209, 6] ,[209, 7] ,
        #                               [210, 0],[210, 1] ,[210, 2] ,[210, 3] ,[210, 4] ,[210, 5] ,[210, 6] ,[210, 7] ,
        #                               [211, 0],[211, 1] ,[211, 2] ,[211, 3] ,[211, 4] ,[211, 5] ,[211, 6] ,[211, 7] ,
        #                               [212, 0],[212, 1] ,[212, 2] ,[212, 3] ,[212, 4] ,[212, 5] ,[212, 6] ,[212, 7] ,
        #                               [213, 0],[213, 1] ,[213, 2] ,[213, 3] ,[213, 4] ,[213, 5] ,[213, 6] ,[213, 7] ,
        #                               [214, 0],[214, 1] ,[214, 2] ,[214, 3] ,[214, 4] ,[214, 5] ,[214, 6] ,[214, 7] ,
        #                               [215, 0],[215, 1] ,[215, 2] ,[215, 3] ,[215, 4] ,[215, 5] ,[215, 6] ,[215, 7] ,
        #                               [216, 0],[216, 1] ,[216, 2] ,[216, 3] ,[216, 4] ,[216, 5] ,[216, 6] ,[216, 7] ,
        #                               [217, 0],[217, 1] ,[217, 2] ,[217, 3] ,[217, 4] ,[217, 5] ,[217, 6] ,[217, 7] ,
        #                               [218, 0],[218, 1] ,[218, 2] ,[218, 3] ,[218, 4] ,[218, 5] ,[218, 6] ,[218, 7] ,
        #                               [219, 0],[219, 1] ,[219, 2] ,[219, 3] ,[219, 4] ,[219, 5] ,[219, 6] ,[219, 7] ,
        #                               [220, 0],[220, 1] ,[220, 2] ,[220, 3] ,[220, 4] ,[220, 5] ,[220, 6] ,[220, 7] ,
        #                               [221, 0],[221, 1] ,[221, 2] ,[221, 3] ,[221, 4] ,[221, 5] ,[221, 6] ,[221, 7] ,
        #                               [222, 0],[222, 1] ,[222, 2] ,[222, 3] ,[222, 4] ,[222, 5] ,[222, 6] ,[222, 7] ,
        #                               [223, 0],[223, 1] ,[223, 2] ,[223, 3] ,[223, 4] ,[223, 5] ,[223, 6] ,[223, 7] ,
        #                               [224, 0],[224, 1] ,[224, 2] ,[224, 3] ,[224, 4] ,[224, 5] ,[224, 6] ,[224, 7] ,
        #                               [225, 0],[225, 1] ,[225, 2] ,[225, 3] ,[225, 4] ,[225, 5] ,[225, 6] ,[225, 7] ,
        #                               [226, 0],[226, 1] ,[226, 2] ,[226, 3] ,[226, 4] ,[226, 5] ,[226, 6] ,[226, 7] ,
        #                               [227, 0],[227, 1] ,[227, 2] ,[227, 3] ,[227, 4] ,[227, 5] ,[227, 6] ,[227, 7] ,
        #                               [228, 0],[228, 1] ,[228, 2] ,[228, 3] ,[228, 4] ,[228, 5] ,[228, 6] ,[228, 7] ,
        #                               [229, 0],[229, 1] ,[229, 2] ,[229, 3] ,[229, 4] ,[229, 5] ,[229, 6] ,[229, 7] ,
        #                               [230, 0],[230, 1] ,[230, 2] ,[230, 3] ,[230, 4] ,[230, 5] ,[230, 6] ,[230, 7] ,
        #                               [231, 0],[231, 1] ,[231, 2] ,[231, 3] ,[231, 4] ,[231, 5] ,[231, 6] ,[231, 7] ,
        #                               [232, 0],[232, 1] ,[232, 2] ,[232, 3] ,[232, 4] ,[232, 5] ,[232, 6] ,[232, 7] ,
        #                               [233, 0],[233, 1] ,[233, 2] ,[233, 3] ,[233, 4] ,[233, 5] ,[233, 6] ,[233, 7] ,
        #                               [234, 0],[234, 1] ,[234, 2] ,[234, 3] ,[234, 4] ,[234, 5] ,[234, 6] ,[234, 7] ,
        #                               [235, 0],[235, 1] ,[235, 2] ,[235, 3] ,[235, 4] ,[235, 5] ,[235, 6] ,[235, 7] ,
        #                               [236, 0],[236, 1] ,[236, 2] ,[236, 3] ,[236, 4] ,[236, 5] ,[236, 6] ,[236, 7] ,
        #                               [237, 0],[237, 1] ,[237, 2] ,[237, 3] ,[237, 4] ,[237, 5] ,[237, 6] ,[237, 7] ,
        #                               [238, 0],[238, 1] ,[238, 2] ,[238, 3] ,[238, 4] ,[238, 5] ,[238, 6] ,[238, 7] ,
        #                               [239, 0],[239, 1] ,[239, 2] ,[239, 3] ,[239, 4] ,[239, 5] ,[239, 6] ,[239, 7] ,
        #                               [240, 0],[240, 1] ,[240, 2] ,[240, 3] ,[240, 4] ,[240, 5] ,[240, 6] ,[240, 7] ,
        #                               [241, 0],[241, 1] ,[241, 2] ,[241, 3] ,[241, 4] ,[241, 5] ,[241, 6] ,[241, 7] ,
        #                               [242, 0],[242, 1] ,[242, 2] ,[242, 3] ,[242, 4] ,[242, 5] ,[242, 6] ,[242, 7] ,
        #                               [243, 0],[243, 1] ,[243, 2] ,[243, 3] ,[243, 4] ,[243, 5] ,[243, 6] ,[243, 7] ,
        #                               [244, 0],[244, 1] ,[244, 2] ,[244, 3] ,[244, 4] ,[244, 5] ,[244, 6] ,[244, 7] ,
        #                               [245, 0],[245, 1] ,[245, 2] ,[245, 3] ,[245, 4] ,[245, 5] ,[245, 6] ,[245, 7] ,
        #                               [246, 0],[246, 1] ,[246, 2] ,[246, 3] ,[246, 4] ,[246, 5] ,[246, 6] ,[246, 7] ,
        #                               [247, 0],[247, 1] ,[247, 2] ,[247, 3] ,[247, 4] ,[247, 5] ,[247, 6] ,[247, 7] ,
        #                               [248, 0],[248, 1] ,[248, 2] ,[248, 3] ,[248, 4] ,[248, 5] ,[248, 6] ,[248, 7] ,
        #                               [249, 0],[249, 1] ,[249, 2] ,[249, 3] ,[249, 4] ,[249, 5] ,[249, 6] ,[249, 7] ,
        #                               [250, 0],[250, 1] ,[250, 2] ,[250, 3] ,[250, 4] ,[250, 5] ,[250, 6] ,[250, 7] ,
        #                               [251, 0],[251, 1] ,[251, 2] ,[251, 3] ,[251, 4] ,[251, 5] ,[251, 6] ,[251, 7] ,
        #                               [252, 0],[252, 1] ,[252, 2] ,[252, 3] ,[252, 4] ,[252, 5] ,[252, 6] ,[252, 7] ,
        #                               [253, 0],[253, 1] ,[253, 2] ,[253, 3] ,[253, 4] ,[253, 5] ,[253, 6] ,[253, 7] ,
        #                               [254, 0],[254, 1] ,[254, 2] ,[254, 3] ,[254, 4] ,[254, 5] ,[254, 6] ,[254, 7] ,
        #                               [255, 0],[255, 1] ,[255, 2] ,[255, 3] ,[255, 4] ,[255, 5] ,[255, 6] ,[255, 7] ,
        #                               [256, 0],[256, 1] ,[256, 2] ,[256, 3] ,[256, 4] ,[256, 5] ,[256, 6] ,[256, 7] ,
        #                               [257, 0],[257, 1] ,[257, 2] ,[257, 3] ,[257, 4] ,[257, 5] ,[257, 6] ,[257, 7] ,
        #                               [258, 0],[258, 1] ,[258, 2] ,[258, 3] ,[258, 4] ,[258, 5] ,[258, 6] ,[258, 7] ,
        #                               [259, 0],[259, 1] ,[259, 2] ,[259, 3] ,[259, 4] ,[259, 5] ,[259, 6] ,[259, 7] ,
        #                               [260, 0],[260, 1] ,[260, 2] ,[260, 3] ,[260, 4] ,[260, 5] ,[260, 6] ,[260, 7] ,
        #                               [261, 0],[261, 1] ,[261, 2] ,[261, 3] ,[261, 4] ,[261, 5] ,[261, 6] ,[261, 7] ,
        #                               [262, 0],[262, 1] ,[262, 2] ,[262, 3] ,[262, 4] ,[262, 5] ,[262, 6] ,[262, 7] ,
        #                               [263, 0],[263, 1] ,[263, 2] ,[263, 3] ,[263, 4] ,[263, 5] ,[263, 6] ,[263, 7] ,
        #                               [264, 0],[264, 1] ,[264, 2] ,[264, 3] ,[264, 4] ,[264, 5] ,[264, 6] ,[264, 7] ,
        #                               [265, 0],[265, 1] ,[265, 2] ,[265, 3] ,[265, 4] ,[265, 5] ,[265, 6] ,[265, 7] ,
        #                               [266, 0],[266, 1] ,[266, 2] ,[266, 3] ,[266, 4] ,[266, 5] ,[266, 6] ,[266, 7] ,
        #                               [267, 0],[267, 1] ,[267, 2] ,[267, 3] ,[267, 4] ,[267, 5] ,[267, 6] ,[267, 7] ,
        #                               [268, 0],[268, 1] ,[268, 2] ,[268, 3] ,[268, 4] ,[268, 5] ,[268, 6] ,[268, 7] ,
        #                               [269, 0],[269, 1] ,[269, 2] ,[269, 3] ,[269, 4] ,[269, 5] ,[269, 6] ,[269, 7] ,
        #                               [270, 0],[270, 1] ,[270, 2] ,[270, 3] ,[270, 4] ,[270, 5] ,[270, 6] ,[270, 7] ,
        #                               [271, 0],[271, 1] ,[271, 2] ,[271, 3] ,[271, 4] ,[271, 5] ,[271, 6] ,[271, 7] ,
        #                               [272, 0],[272, 1] ,[272, 2] ,[272, 3] ,[272, 4] ,[272, 5] ,[272, 6] ,[272, 7] ,
        #                               [273, 0],[273, 1] ,[273, 2] ,[273, 3] ,[273, 4] ,[273, 5] ,[273, 6] ,[273, 7] ,
        #                               [274, 0],[274, 1] ,[274, 2] ,[274, 3] ,[274, 4] ,[274, 5] ,[274, 6] ,[274, 7] ,
        #                               [275, 0],[275, 1] ,[275, 2] ,[275, 3] ,[275, 4] ,[275, 5] ,[275, 6] ,[275, 7] ,
        #                               [276, 0],[276, 1] ,[276, 2] ,[276, 3] ,[276, 4] ,[276, 5] ,[276, 6] ,[276, 7] ,
        #                               [277, 0],[277, 1] ,[277, 2] ,[277, 3] ,[277, 4] ,[277, 5] ,[277, 6] ,[277, 7] ,
        #                               [278, 0],[278, 1] ,[278, 2] ,[278, 3] ,[278, 4] ,[278, 5] ,[278, 6] ,[278, 7] ,
        #                               [279, 0],[279, 1] ,[279, 2] ,[279, 3] ,[279, 4] ,[279, 5] ,[279, 6] ,[279, 7] ,
        #                               [280, 0],[280, 1] ,[280, 2] ,[280, 3] ,[280, 4] ,[280, 5] ,[280, 6] ,[280, 7] ,
        #                               [281, 0],[281, 1] ,[281, 2] ,[281, 3] ,[281, 4] ,[281, 5] ,[281, 6] ,[281, 7] ,
        #                               [282, 0],[282, 1] ,[282, 2] ,[282, 3] ,[282, 4] ,[282, 5] ,[282, 6] ,[282, 7] ,
        #                               [283, 0],[283, 1] ,[283, 2] ,[283, 3] ,[283, 4] ,[283, 5] ,[283, 6] ,[283, 7] ,
        #                               [284, 0],[284, 1] ,[284, 2] ,[284, 3] ,[284, 4] ,[284, 5] ,[284, 6] ,[284, 7] ,
        #                               [285, 0],[285, 1] ,[285, 2] ,[285, 3] ,[285, 4] ,[285, 5] ,[285, 6] ,[285, 7] ,
        #                               [286, 0],[286, 1] ,[286, 2] ,[286, 3] ,[286, 4] ,[286, 5] ,[286, 6] ,[286, 7] ,
        #                               [287, 0],[287, 1] ,[287, 2] ,[287, 3] ,[287, 4] ,[287, 5] ,[287, 6] ,[287, 7] ,
        #                               [288, 0],[288, 1] ,[288, 2] ,[288, 3] ,[288, 4] ,[288, 5] ,[288, 6] ,[288, 7] ,
        #                               [289, 0],[289, 1] ,[289, 2] ,[289, 3] ,[289, 4] ,[289, 5] ,[289, 6] ,[289, 7] ,
        #                               [290, 0],[290, 1] ,[290, 2] ,[290, 3] ,[290, 4] ,[290, 5] ,[290, 6] ,[290, 7] ,
        #                               [291, 0],[291, 1] ,[291, 2] ,[291, 3] ,[291, 4] ,[291, 5] ,[291, 6] ,[291, 7] ,
        #                               [292, 0],[292, 1] ,[292, 2] ,[292, 3] ,[292, 4] ,[292, 5] ,[292, 6] ,[292, 7] ,
        #                               [293, 0],[293, 1] ,[293, 2] ,[293, 3] ,[293, 4] ,[293, 5] ,[293, 6] ,[293, 7] ,
        #                               [294, 0],[294, 1] ,[294, 2] ,[294, 3] ,[294, 4] ,[294, 5] ,[294, 6] ,[294, 7] ,
        #                               [295, 0],[295, 1] ,[295, 2] ,[295, 3] ,[295, 4] ,[295, 5] ,[295, 6] ,[295, 7] ,
        #                               [296, 0],[296, 1] ,[296, 2] ,[296, 3] ,[296, 4] ,[296, 5] ,[296, 6] ,[296, 7] ,
        #                               [297, 0],[297, 1] ,[297, 2] ,[297, 3] ,[297, 4] ,[297, 5] ,[297, 6] ,[297, 7] ,
        #                               [298, 0],[298, 1] ,[298, 2] ,[298, 3] ,[298, 4] ,[298, 5] ,[298, 6] ,[298, 7] ,
        #                               [299, 0],[299, 1] ,[299, 2] ,[299, 3] ,[299, 4] ,[299, 5] ,[299, 6] ,[299, 7] ,
        #                               [300, 0],[300, 1] ,[300, 2] ,[300, 3] ,[300, 4] ,[300, 5] ,[300, 6] ,[300, 7] ,
        #                               [301, 0],[301, 1] ,[301, 2] ,[301, 3] ,[301, 4] ,[301, 5] ,[301, 6] ,[301, 7] ,
        #                               [302, 0],[302, 1] ,[302, 2] ,[302, 3] ,[302, 4] ,[302, 5] ,[302, 6] ,[302, 7] ,
        #                               [303, 0],[303, 1] ,[303, 2] ,[303, 3] ,[303, 4] ,[303, 5] ,[303, 6] ,[303, 7] ,
        #                               [304, 0],[304, 1] ,[304, 2] ,[304, 3] ,[304, 4] ,[304, 5] ,[304, 6] ,[304, 7] ,
        #                               [305, 0],[305, 1] ,[305, 2] ,[305, 3] ,[305, 4] ,[305, 5] ,[305, 6] ,[305, 7] ,
        #                               [306, 0],[306, 1] ,[306, 2] ,[306, 3] ,[306, 4] ,[306, 5] ,[306, 6] ,[306, 7] ,
        #                               [307, 0],[307, 1] ,[307, 2] ,[307, 3] ,[307, 4] ,[307, 5] ,[307, 6] ,[307, 7] ,
        #                               [308, 0],[308, 1] ,[308, 2] ,[308, 3] ,[308, 4] ,[308, 5] ,[308, 6] ,[308, 7] ,
        #                               [309, 0],[309, 1] ,[309, 2] ,[309, 3] ,[309, 4] ,[309, 5] ,[309, 6] ,[309, 7] ,
        #                               [310, 0],[310, 1] ,[310, 2] ,[310, 3] ,[310, 4] ,[310, 5] ,[310, 6] ,[310, 7] ,
        #                               [311, 0],[311, 1] ,[311, 2] ,[311, 3] ,[311, 4] ,[311, 5] ,[311, 6] ,[311, 7] ,
        #                               [312, 0],[312, 1] ,[312, 2] ,[312, 3] ,[312, 4] ,[312, 5] ,[312, 6] ,[312, 7] ,
        #                               [313, 0],[313, 1] ,[313, 2] ,[313, 3] ,[313, 4] ,[313, 5] ,[313, 6] ,[313, 7] ,
        #                               [314, 0],[314, 1] ,[314, 2] ,[314, 3] ,[314, 4] ,[314, 5] ,[314, 6] ,[314, 7] ,
        #                               [315, 0],[315, 1] ,[315, 2] ,[315, 3] ,[315, 4] ,[315, 5] ,[315, 6] ,[315, 7] ,
        #                               [316, 0],[316, 1] ,[316, 2] ,[316, 3] ,[316, 4] ,[316, 5] ,[316, 6] ,[316, 7] ,
        #                               [317, 0],[317, 1] ,[317, 2] ,[317, 3] ,[317, 4] ,[317, 5] ,[317, 6] ,[317, 7] ,
        #                               [318, 0],[318, 1] ,[318, 2] ,[318, 3] ,[318, 4] ,[318, 5] ,[318, 6] ,[318, 7] ,
        #                               [319, 0],[319, 1] ,[319, 2] ,[319, 3] ,[319, 4] ,[319, 5] ,[319, 6] ,[319, 7] ,
        #                               [320, 0],[320, 1] ,[320, 2] ,[320, 3] ,[320, 4] ,[320, 5] ,[320, 6] ,[320, 7] ,
        #                               [321, 0],[321, 1] ,[321, 2] ,[321, 3] ,[321, 4] ,[321, 5] ,[321, 6] ,[321, 7] ,
        #                               [322, 0],[322, 1] ,[322, 2] ,[322, 3] ,[322, 4] ,[322, 5] ,[322, 6] ,[322, 7] ,
        #                               [323, 0],[323, 1] ,[323, 2] ,[323, 3] ,[323, 4] ,[323, 5] ,[323, 6] ,[323, 7] ,
        #                               [324, 0],[324, 1] ,[324, 2] ,[324, 3] ,[324, 4] ,[324, 5] ,[324, 6] ,[324, 7] ,
        #                               [325, 0],[325, 1] ,[325, 2] ,[325, 3] ,[325, 4] ,[325, 5] ,[325, 6] ,[325, 7] ,
        #                               [326, 0],[326, 1] ,[326, 2] ,[326, 3] ,[326, 4] ,[326, 5] ,[326, 6] ,[326, 7]])
        self.action_space = np.array(self.action_list())
        self.n_actions = len(self.action_space)
        self.state_init = state_init

        self.cost_init = self.cost_init()

    def step(self, action, state, costs):
        s = state.copy()
        #action_real[查询，移动到的服务器]
        if isinstance(action, np.ndarray):
           action = action[0]
        action_real = self.action_space[action]
        q = action_real[0]
        index_server = action_real[1]
        s.iloc[q, :] = 0
        s.iloc[q, index_server] = 1

        cost_new = self.cost_caculate(q, index_server)

        costs[q] = cost_new
        cost_all = self.cost_all(costs)
        reward = self.reward(cost_all, s)
        s_ = s

        return s_, costs, reward, cost_all


    #判断结束的条件 选择的action在执行之后状态仍然没有变 or 判断状态是否在处与某种情况下，例如负载不平衡
    def action_list(self):
        action = []
        for i in range(len(self.QSs)):
            for j in range(self.server_number):
                li = []
                li.append(i)
                li.append(j)
                action.append(li)
        return action

    # read the file and store in an array[query,[server1,server2,......]]
    def read_file(self):
        server_attribute = self.server_attribute
        with open("./QueryAttribute", 'r') as f:
            content = f.readlines()
            QSs = []
            for item in content:
                QS = []
                item = item.strip("\n")
                q = item.split(",")[0]
                targetAttribute = item.split(",")[1:]
                targetAttribute = list(map(int, targetAttribute))
                servers = []
                for attribute in targetAttribute:
                    server = server_attribute[server_attribute.loc[:, attribute] == 1].index[0]
                    servers.append(server)
                QS.append(int(q))
                QS.append(servers)
                QSs.append(QS)
        return QSs

    # compute the initial costs array based on the initial state matrix. every element represent the total cost of the query
    def cost_init(self):
        state_init = self.state_init
        # print(len(state_init))
        states = self.state_array(state_init)
        # print(len(states))
        costs = []
        # print(len(state_init))
        for i in range(len(state_init)):
            index_server = states[i][1]
            cost = self.cost_caculate(i,  index_server)
            costs.append(cost)
        return costs


    def cost_caculate(self,q,index_server):
        cost = 0
        for j in range(len(self.QSs[q][1])):
            target_server = self.QSs[q][1][j]
            cost += self.cost_matrix.iloc[index_server, target_server]
        return cost


    # create the initial state matrix（random）


    # compute the total reward based on the costs array
    def cost_all(self, costs):
        cost_all = 0
        for i in range(len(costs)):
            cost_all += costs[i]
        return cost_all

    def reward(self, cost_all, state):
        list = []
        for i in state.columns:
            list.append(state[i].sum())

        load_weight_var = np.var(list)
        reward = (len(state)/cost_all) * self.function(1.1, load_weight_var)
        return reward

    def function(self, a, x):
        y = 100/(a**x)
        return y

    # transform the state matrix into array
    def state_array(self, state):
        states = []
        for i in range(len(state)):
            for j in range(len(state.columns)):
                state_arr = []
                if state.iloc[i, j] == 1:
                    state_arr.append(i)
                    state_arr.append(j)
                    states.append(state_arr)
        return states

# def state_init():
#     init_state = pd.DataFrame(np.zeros(12*4).reshape(12, 4), columns=[0, 1, 2, 3])
#     for i in range(len(init_state)):
#         j = random.randint(0, 3)
#         init_state.iloc[i][j] = 1
#     return init_state

# if __name__ == '__main__':
#     server_attribute = pd.DataFrame(np.array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
#                                               0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
#                                               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0,
#                                               1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0,
#                                               0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
#                                               0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0,
#                                               0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
#                                               0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]).
#                                     reshape(8, 24),
#                                     columns=np.arange(24))

    # env = Cluster(state_init(), server_attribute)
    # Qss = env.QSs
    # print(Qss)
    # for i in range(len(Qss)):
    #     q = i
    #     for j in range(len(server_attribute)):
    #         index_server = j



    # print(env.cost_init)
    # print("The reward of initial state is:")
    # print(env.reward(env.cost_all(env.cost_init), env.state_init))

    # print(env.state_init)
    # actions=list(range(env.n_actions))
    # print(actions)
    # env.after(100, update)
    # env.mainloop()